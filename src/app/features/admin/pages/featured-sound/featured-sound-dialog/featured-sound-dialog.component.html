<h2 mat-dialog-title>
  {{ (isEditMode() ? 'admin.featuredSound.dialog.editTitle' : 'admin.featuredSound.dialog.createTitle') | translate }}
</h2>

<mat-dialog-content>
  <mat-tab-group>
    <!-- Info Tab -->
    <mat-tab [label]="'admin.featuredSound.dialog.tabInfo' | translate">
      <div class="tab-content">
        <form [formGroup]="form">
          <!-- Sound Selection -->
          <h4>{{ 'admin.featuredSound.dialog.selectSound' | translate }}</h4>

          @if (selectedSound()) {
            <div class="selected-sound">
              <mat-icon>music_note</mat-icon>
              <div class="selected-sound-info">
                <strong>{{ getLocalizedTitle(selectedSound()!) }}</strong>
                @if (selectedSound()!.city) {
                  <span class="sound-city">{{ selectedSound()!.city }}</span>
                }
              </div>
              <button mat-icon-button (click)="clearSound()" [disabled]="isEditMode()">
                <mat-icon>close</mat-icon>
              </button>
            </div>
          } @else {
            <mat-form-field appearance="outline" class="full-width">
              <mat-label>{{ 'admin.featuredSound.dialog.searchSound' | translate }}</mat-label>
              <input
                matInput
                [formControl]="searchControl"
                [matAutocomplete]="auto"
              />
              <mat-icon matSuffix>search</mat-icon>
              <mat-autocomplete #auto="matAutocomplete">
                @for (sound of filteredSounds(); track sound.id) {
                  <mat-option (onSelectionChange)="selectSound(sound)">
                    <div class="sound-option">
                      <span class="sound-title">{{ getLocalizedTitle(sound) }}</span>
                      @if (sound.city) {
                        <span class="sound-city">{{ sound.city }}</span>
                      }
                    </div>
                  </mat-option>
                }
              </mat-autocomplete>
            </mat-form-field>
          }

          <!-- Teasing -->
          <mat-form-field appearance="outline" class="full-width">
            <mat-label>{{ 'admin.featuredSound.dialog.teasing' | translate }}</mat-label>
            <textarea matInput formControlName="teasing" rows="2" required></textarea>
            <mat-hint>{{ 'admin.featuredSound.dialog.teasingHint' | translate }}</mat-hint>
          </mat-form-field>

          <!-- Options -->
          <div class="row">
            <mat-form-field appearance="outline">
              <mat-label>#</mat-label>
              <input matInput type="number" formControlName="sortOrder" />
            </mat-form-field>

            <mat-slide-toggle formControlName="isActive">
              Active
            </mat-slide-toggle>
          </div>
        </form>
      </div>
    </mat-tab>

    <!-- Translations Tab -->
    <mat-tab [label]="'admin.featuredSound.dialog.tabTranslations' | translate">
      <div class="tab-content">
        <form [formGroup]="form">
          <h4>{{ 'admin.featuredSound.dialog.teasingTranslations' | translate }}</h4>
          <mat-form-field appearance="outline" class="full-width">
            <mat-label>Français</mat-label>
            <textarea matInput formControlName="teasing_fr" rows="2"></textarea>
          </mat-form-field>
          <mat-form-field appearance="outline" class="full-width">
            <mat-label>English</mat-label>
            <textarea matInput formControlName="teasing_en" rows="2"></textarea>
          </mat-form-field>
          <mat-form-field appearance="outline" class="full-width">
            <mat-label>Español</mat-label>
            <textarea matInput formControlName="teasing_es" rows="2"></textarea>
          </mat-form-field>
        </form>
      </div>
    </mat-tab>
  </mat-tab-group>
</mat-dialog-content>

<mat-dialog-actions align="end">
  <button mat-button (click)="cancel()" [disabled]="saving()">
    {{ 'common.action.cancel' | translate }}
  </button>
  <button
    mat-raised-button
    color="primary"
    (click)="save()"
    [disabled]="saving() || !form.valid"
  >
    @if (saving()) {
      <mat-spinner diameter="20"></mat-spinner>
    } @else {
      {{ 'common.action.save' | translate }}
    }
  </button>
</mat-dialog-actions>
